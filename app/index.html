<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seafar Nexus - 命盤管理</title>
    <link rel="icon" href="assets/icon.png" type="image/png">
    <link rel="stylesheet" href="css/index.css">
    
    <script src="js/lang/i18n.js" defer></script>
    <script src="assets/calendar/LunarSolarConverter.js" defer></script>
    <script src="js/view/modal.js" defer></script>
    <script src="js/view/dashboard.js" defer></script>
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <h1>Seafar Nexus - 命盤管理儀表板</h1>
            <button id="add-new-case-btn" class="add-btn" disabled>新增命例 +</button>
        </header>
        <div class="dashboard-body">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2>分類</h2>
                </div>
                <ul id="category-list"></ul>
                <div class="category-management">
                    <button id="add-category-btn" title="新增分類" disabled>+</button>
                    <button id="rename-category-btn" title="重新命名選取的分類" disabled>✏️</button>
                    <button id="delete-category-btn" title="刪除選取的分類">🗑️</button>
                </div>
            </aside>
            <main class="main-content">
                <div class="toolbar">
                    <input type="text" id="search-box" placeholder="搜尋名稱..." disabled>
                </div>
<div id="initial-prompt">
                    <h2>開始使用 Seafar Nexus</h2>
                    <p>請先設定您的「UserData」命例資料夾：</p>
                    
                    <div class="instructions">
                        <ol>
                            <li>
                                <strong>如果您是 C.M.Song 博士 C++ 排盤程式的使用者：</strong><br>
                                請將您現有的 <code>UserData</code> 資料夾完整「<strong>複製一份</strong>」到您電腦的其他位置，然後點擊下方按鈕，選擇這個新複製的資料夾。
                            </li>
                            <li>
                                <strong>如果您是新使用者：</strong><br>
                                請在您的電腦上任意位置，手動「<strong>建立一個</strong>」名為 <code>UserData</code> 的新資料夾，然後點擊下方按鈕，選擇它。
                            </li>
                        </ol>
                    </div>

                    <button id="select-folder-btn" class="add-btn">選擇 UserData 資料夾</button>
                    <p class="small-text">您的所有資料將保留在您自己的電腦上，本網站不會上傳任何資訊。</p>
                </div>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>名稱</th><th>性別</th><th>陽曆生日</th><th>陰曆生日</th><th>分類</th><th>操作</th><th>排盤</th><th>分析</th>
                            </tr>
                        </thead>
                        <tbody id="case-list-body"></tbody>
                    </table>
                </div>
                <div id="pagination-controls" class="pagination"></div>
            </main>
        </div>
    </div>

    <div id="case-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-modal-btn" class="close-btn">&times;</button>
            <h1 id="modal-title">新增命例</h1>
             <input type="hidden" id="case-id" value="">
            <form id="birth-info-form">
                 <div class="input-group">
                    <label>使用者前綴 (Prefix)</label>
                    <p id="prefix-display" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; background-color: #e9ecef; margin: 0;"></p>
                    <p style="color: blue; font-size: 12px; margin-top: 5px;">Prefix預設為SeafarNexus, 用來識別案例資料夾由誰建立，便於分享時區分資料夾內容。</p>
                </div>
                 <div class="input-group">
                    <label for="name">名稱 (姓名或主題)</label>
                    <input type="text" id="name" required>
                </div>
                 <div class="input-group">
                    <label for="category-select">分類</label>
                    <select id="category-select"></select>
                </div>
                <div class="input-group radio-group">
                    <label><input type="radio" name="inputType" value="solar" checked> 陽曆</label>
                    <label><input type="radio" name="inputType" value="lunar"> 陰曆</label>
                </div>
                <div id="solar-inputs">
                    <div class="input-group date-group">
                        <div><label>年</label><select id="solar-year"></select></div>
                        <div><label>月</label><select id="solar-month"></select></div>
                        <div><label>日</label><select id="solar-day"></select></div>
                    </div>
                    <p id="solar-year-warning" class="year-warning hidden"></p>
                     <div class="input-group date-group">
                        <div><label>時 (0-23)</label><select id="solar-hour"></select></div>
                        <div><label>分 (0-59)</label><select id="solar-minute"></select></div>
                    </div>
                </div>
                <div id="lunar-inputs" class="hidden">
                     <div class="input-group date-group">
                        <div><label>年</label><input type="text" id="lunar-year" inputmode="numeric" pattern="[0-9]*" maxlength="4"></div>
                        <div><label>月</label><select id="lunar-month"></select></div>
                        <div><label>日</label><select id="lunar-day"></select></div>
                    </div>
                    <p id="lunar-year-warning" class="year-warning hidden"></p>
                    <div class="input-group date-group">
                        <div><label>時辰</label><select id="lunar-hour"></select></div>
                        <div style="text-align:center;"><label>閏月</label><input type="checkbox" id="is-leap"></div>
                    </div>
                </div>
                <div class="input-group radio-group">
                    <label><input type="radio" name="gender" value="M" checked> 男</label>
                    <label><input type="radio" name="gender" value="F"> 女</label>
                </div>
                <button type="submit" class="submit-btn">儲存命例</button>
            </form>
        </div>
    </div>
    <div id="input-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="input-modal-title"></h2>
            <p id="input-modal-message"></p>
            <div class="input-group">
                <input type="text" id="input-modal-field">
            </div>
            <div class="input-modal-actions">
                <button id="input-modal-cancel" class="action-btn">取消</button>
                <button id="input-modal-ok" class="add-btn">確定</button>
            </div>
        </div>
    </div>
</body>
</html>